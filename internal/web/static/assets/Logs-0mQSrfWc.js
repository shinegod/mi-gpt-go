import{_ as Y,u as Z,r as d,a4 as R,N as A,o as ee,d as le,e as h,f as y,g as e,w as a,l as te,K as g,a5 as N,m as s,E as ae,k as se,T as oe,U as ne,W as re,n as ue,j as W,a6 as ie,a7 as de,A as x,D as ce,t as c,a8 as K,i as ve,V as _e,a2 as pe,a9 as fe,G as me,B as ge,C as we,aa as Le,J as be}from"./index-48GxJGop.js";/* empty css                *//* empty css               *//* empty css                 *//* empty css                  */const Ce={class:"logs-page"},Ve={class:"card-header"},he={class:"header-actions"},ye={class:"log-filters"},xe={class:"level-info"},Ee={class:"log-container"},ke={class:"log-time"},Se={class:"log-level"},Te={class:"log-message"},Ue={key:0,class:"no-logs"},Be={class:"log-stats"},Ie={class:"stat-item"},ze={class:"stat-value"},Ne={class:"stat-item"},We={class:"stat-value error"},De={class:"stat-item"},Me={class:"stat-value warning"},Re={class:"stat-item"},Ae={class:"stat-value info"},Ke={__name:"Logs",setup($e){const u=Z(),w=d(null),L=d(!0),v=d(""),b=d(""),_=d(500),E=d(!1),C=d("info"),p=d({total:0,error:0,warn:0,info:0,debug:0});let f=null;const k=R(()=>u.logs||[]),D=R(()=>{let t=[...k.value];if(v.value&&(t=t.filter(l=>{const r=l.level.toLowerCase(),m=v.value.toLowerCase();return r===m||m==="warn"&&(r==="warning"||r==="warn")})),b.value){const l=b.value.toLowerCase();t=t.filter(r=>r.message.toLowerCase().includes(l)||r.level.toLowerCase().includes(l))}return _.value>0&&(t=t.slice(-_.value)),t.reverse()}),$=t=>`log-${t.level.toLowerCase()}`,j=t=>new Date(t).toLocaleString(),S=t=>u.logStats&&u.logStats[t]!==void 0?u.logStats[t]:k.value.filter(l=>{const r=l.level.toLowerCase();return t==="warn"?r==="warn"||r==="warning":r===t.toLowerCase()}).length,V=async()=>{try{const t={};v.value&&(t.level=v.value),_.value>0&&(t.limit=_.value),await u.fetchLogs(t),p.value=u.logStats||{total:0,error:0,warn:0,info:0,debug:0},g.success("日志刷新成功"),await N(),U()}catch(t){g.error("日志刷新失败"),console.error("刷新日志失败:",t)}},F=async()=>{try{await be.confirm("确定要清空所有日志吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await u.clearLogs()&&(p.value={total:0,error:0,warn:0,info:0,debug:0},g.success("日志已清空"),await N(),U())}catch{}},G=async t=>{try{await u.setLogLevel(t)&&(g.success(`日志级别已设置为: ${t.toUpperCase()}`),await V())}catch{g.error("设置日志级别失败")}};A(()=>u.logLevel,t=>{C.value=t},{immediate:!0});const T=()=>{N(()=>{U()})},H=()=>{},U=()=>{w.value&&(w.value.scrollTop=w.value.scrollHeight)},B=t=>{t?f=setInterval(V,5e3):f&&(clearInterval(f),f=null)};return A(L,t=>{B(t)},{immediate:!0}),ee(async()=>{await u.fetchLogLevel(),await V(),L.value&&B(!0)}),le(()=>{f&&clearInterval(f)}),(t,l)=>{const r=me,m=ue,M=ge,n=ne,I=oe,i=se,J=re,z=ae,O=de,q=ce,P=fe,Q=te;return y(),h("div",Ce,[e(Q,null,{header:a(()=>[s("div",Ve,[l[8]||(l[8]=s("span",null,"系统日志",-1)),s("div",he,[e(r,{modelValue:L.value,"onUpdate:modelValue":l[0]||(l[0]=o=>L.value=o),"active-text":"自动刷新",onChange:B},null,8,["modelValue"]),e(M,{size:"small",onClick:V},{default:a(()=>[e(m,null,{default:a(()=>[e(W(we))]),_:1}),l[6]||(l[6]=x(" 刷新 "))]),_:1,__:[6]}),e(M,{size:"small",onClick:F},{default:a(()=>[e(m,null,{default:a(()=>[e(W(Le))]),_:1}),l[7]||(l[7]=x(" 清空 "))]),_:1,__:[7]})])])]),default:a(()=>[s("div",ye,[e(z,{gutter:15},{default:a(()=>[e(i,{span:6},{default:a(()=>[e(I,{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=o=>v.value=o),placeholder:"过滤级别",clearable:"",onChange:T},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"错误",value:"error"}),e(n,{label:"警告",value:"warn"}),e(n,{label:"信息",value:"info"}),e(n,{label:"调试",value:"debug"})]),_:1},8,["modelValue"])]),_:1}),e(i,{span:6},{default:a(()=>[e(I,{modelValue:C.value,"onUpdate:modelValue":l[2]||(l[2]=o=>C.value=o),placeholder:"系统日志级别",onChange:G},{prefix:a(()=>l[9]||(l[9]=[s("span",{style:{color:"#909399","font-size":"12px"}},"系统级别:",-1)])),default:a(()=>[e(n,{label:"错误",value:"error"}),e(n,{label:"警告",value:"warn"}),e(n,{label:"信息",value:"info"}),e(n,{label:"调试",value:"debug"})]),_:1},8,["modelValue"])]),_:1}),e(i,{span:8},{default:a(()=>[e(J,{modelValue:b.value,"onUpdate:modelValue":l[3]||(l[3]=o=>b.value=o),placeholder:"搜索日志内容...",clearable:"",onInput:T},{prefix:a(()=>[e(m,null,{default:a(()=>[e(W(ie))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,{span:4},{default:a(()=>[e(I,{modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=o=>_.value=o),placeholder:"显示行数",onChange:T},{default:a(()=>[e(n,{label:"最近100行",value:100}),e(n,{label:"最近500行",value:500}),e(n,{label:"最近1000行",value:1e3}),e(n,{label:"全部",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(z,{gutter:15,style:{"margin-top":"10px"}},{default:a(()=>[e(i,{span:4},{default:a(()=>[e(O,{modelValue:E.value,"onUpdate:modelValue":l[5]||(l[5]=o=>E.value=o),onChange:H},{default:a(()=>l[10]||(l[10]=[x("自动换行")])),_:1,__:[10]},8,["modelValue"])]),_:1}),e(i,{span:20},{default:a(()=>[s("div",xe,[e(q,{size:"small",type:"info"},{default:a(()=>[x("当前系统日志级别: "+c(C.value.toUpperCase()),1)]),_:1}),l[11]||(l[11]=s("span",{style:{"margin-left":"10px",color:"#909399","font-size":"12px"}}," 调试级别可显示更详细的日志信息 ",-1))])]),_:1})]),_:1})]),s("div",Ee,[s("div",{ref_key:"logContent",ref:w,class:K(["log-content",{"word-wrap":E.value}])},[(y(!0),h(_e,null,pe(D.value,(o,X)=>(y(),h("div",{key:X,class:K(["log-line",$(o)])},[s("span",ke,c(j(o.time)),1),s("span",Se,c(o.level),1),s("span",Te,c(o.message),1)],2))),128)),D.value.length===0?(y(),h("div",Ue,[e(P,{description:"暂无日志数据"})])):ve("",!0)],2)]),s("div",Be,[e(z,{gutter:20},{default:a(()=>[e(i,{span:6},{default:a(()=>[s("div",Ie,[l[12]||(l[12]=s("span",{class:"stat-label"},"总日志数:",-1)),s("span",ze,c(p.value.total||k.value.length),1)])]),_:1}),e(i,{span:6},{default:a(()=>[s("div",Ne,[l[13]||(l[13]=s("span",{class:"stat-label"},"错误:",-1)),s("span",We,c(p.value.error||S("error")),1)])]),_:1}),e(i,{span:6},{default:a(()=>[s("div",De,[l[14]||(l[14]=s("span",{class:"stat-label"},"警告:",-1)),s("span",Me,c(p.value.warn||S("warn")),1)])]),_:1}),e(i,{span:6},{default:a(()=>[s("div",Re,[l[15]||(l[15]=s("span",{class:"stat-label"},"信息:",-1)),s("span",Ae,c(p.value.info||S("info")),1)])]),_:1})]),_:1})])]),_:1})])}}},Oe=Y(Ke,[["__scopeId","data-v-b8d5a475"]]);export{Oe as default};
