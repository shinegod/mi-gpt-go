import{_ as T,b as A,r as z,M as P,a4 as S,o as L,d as N,e as k,f as w,g as e,w as t,E as R,k as Q,l as j,m as s,t as c,j as m,F as D,G,Q as K,S as O,Y as X,B as Y,A as H,n as J,X as W,V as Z,a2 as $,h as ee,R as te,K as le}from"./index-48GxJGop.js";/* empty css                 *//* empty css                     *//* empty css                 *//* empty css                *//* empty css                    */const se={class:"concurrent-page"},ae={class:"card-header"},ne={class:"status-item"},ue={class:"status-item"},oe={class:"status-item"},re={class:"status-item"},de={class:"metric-card"},ie={class:"metric-card"},me={class:"process-time"},pe={class:"card-header"},fe={__name:"Concurrent",setup(ce){const o=A(),_=z(!0),g=z(!1);let p=null;const n=P({enabled:!0,workerCount:4,queueSize:100,messageBufferSize:50,rateLimit:10,batchSize:5,batchTimeoutSeconds:5,enableMetrics:!0}),v=S(()=>o.status.queueSize===0?0:Math.round(o.status.currentQueueSize/o.status.queueSize*100)),E=S(()=>{const r=v.value;return r<50?"#67C23A":r<80?"#E6A23C":"#F56C6C"}),x=S(()=>{const r=[];return o.status.enabled||r.push({type:"warning",title:"并发处理未启用",description:"建议启用并发处理以提升系统性能，特别是在高负载场景下。"}),v.value>80&&r.push({type:"error",title:"队列使用率过高",description:"当前队列使用率超过80%，建议增加队列大小或优化处理逻辑。"}),o.status.workerCount<2&&r.push({type:"info",title:"工作线程数较少",description:"建议根据CPU核心数适当增加工作线程数以提升并发处理能力。"}),r.length===0&&r.push({type:"success",title:"配置良好",description:"当前并发处理配置运行良好，系统性能表现正常。"}),r}),C=async()=>{await o.fetchStatus()},y=r=>{r?p=setInterval(C,3e3):p&&(clearInterval(p),p=null)},U=async()=>{g.value=!0;try{await o.updateConfig(n)&&le.success("并发配置保存成功")}finally{g.value=!1}},h=()=>{Object.assign(n,{enabled:o.status.enabled,workerCount:o.status.workerCount,queueSize:o.status.queueSize})};return L(()=>{C().then(()=>{h(),_.value&&y(!0)})}),N(()=>{p&&clearInterval(p)}),(r,l)=>{const b=G,u=Q,d=R,q=D,V=j,B=J,F=Y,i=O,f=X,I=K,M=te;return w(),k("div",se,[e(d,{gutter:20},{default:t(()=>[e(u,{span:24},{default:t(()=>[e(V,null,{header:t(()=>[s("div",ae,[l[9]||(l[9]=s("span",null,"并发处理状态",-1)),e(b,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=a=>_.value=a),"active-text":"自动刷新",onChange:y},null,8,["modelValue"])])]),default:t(()=>[e(d,{gutter:20,class:"status-overview"},{default:t(()=>[e(u,{span:6},{default:t(()=>[s("div",ne,[s("h3",null,c(m(o).status.enabled?"已启用":"已禁用"),1),l[10]||(l[10]=s("p",null,"并发处理",-1))])]),_:1}),e(u,{span:6},{default:t(()=>[s("div",ue,[s("h3",null,c(m(o).status.workerCount),1),l[11]||(l[11]=s("p",null,"工作线程",-1))])]),_:1}),e(u,{span:6},{default:t(()=>[s("div",oe,[s("h3",null,c(m(o).status.currentQueueSize)+"/"+c(m(o).status.queueSize),1),l[12]||(l[12]=s("p",null,"队列使用",-1))])]),_:1}),e(u,{span:6},{default:t(()=>[s("div",re,[s("h3",null,c(m(o).status.processedTasks),1),l[13]||(l[13]=s("p",null,"已处理任务",-1))])]),_:1})]),_:1}),e(d,{gutter:20,class:"performance-metrics"},{default:t(()=>[e(u,{span:12},{default:t(()=>[s("div",de,[l[14]||(l[14]=s("h4",null,"队列使用率",-1)),e(q,{percentage:v.value,"stroke-width":20,"text-inside":!0,color:E.value},null,8,["percentage","color"])])]),_:1}),e(u,{span:12},{default:t(()=>[s("div",ie,[l[15]||(l[15]=s("h4",null,"平均处理时间",-1)),s("div",me,c(m(o).status.averageProcessTime),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{gutter:20,class:"config-section"},{default:t(()=>[e(u,{span:24},{default:t(()=>[e(V,null,{header:t(()=>[s("div",pe,[l[17]||(l[17]=s("span",null,"并发配置管理",-1)),e(F,{type:"primary",size:"small",onClick:U,loading:g.value},{default:t(()=>[e(B,null,{default:t(()=>[e(m(W))]),_:1}),l[16]||(l[16]=H(" 保存配置 "))]),_:1,__:[16]},8,["loading"])])]),default:t(()=>[e(I,{model:n,"label-width":"140px",class:"config-form"},{default:t(()=>[e(d,{gutter:20},{default:t(()=>[e(u,{span:12},{default:t(()=>[e(i,{label:"启用并发处理"},{default:t(()=>[e(b,{modelValue:n.enabled,"onUpdate:modelValue":l[1]||(l[1]=a=>n.enabled=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:t(()=>[e(i,{label:"启用性能指标"},{default:t(()=>[e(b,{modelValue:n.enableMetrics,"onUpdate:modelValue":l[2]||(l[2]=a=>n.enableMetrics=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:20},{default:t(()=>[e(u,{span:12},{default:t(()=>[e(i,{label:"工作线程数"},{default:t(()=>[e(f,{modelValue:n.workerCount,"onUpdate:modelValue":l[3]||(l[3]=a=>n.workerCount=a),min:1,max:16,style:{width:"100%"}},null,8,["modelValue"]),l[18]||(l[18]=s("div",{class:"form-tip"},"推荐设置为CPU核心数",-1))]),_:1,__:[18]})]),_:1}),e(u,{span:12},{default:t(()=>[e(i,{label:"队列大小"},{default:t(()=>[e(f,{modelValue:n.queueSize,"onUpdate:modelValue":l[4]||(l[4]=a=>n.queueSize=a),min:10,max:1e3,step:10,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:20},{default:t(()=>[e(u,{span:12},{default:t(()=>[e(i,{label:"消息缓冲区大小"},{default:t(()=>[e(f,{modelValue:n.messageBufferSize,"onUpdate:modelValue":l[5]||(l[5]=a=>n.messageBufferSize=a),min:10,max:200,step:10,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:t(()=>[e(i,{label:"速率限制(每秒)"},{default:t(()=>[e(f,{modelValue:n.rateLimit,"onUpdate:modelValue":l[6]||(l[6]=a=>n.rateLimit=a),min:1,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:20},{default:t(()=>[e(u,{span:12},{default:t(()=>[e(i,{label:"批处理大小"},{default:t(()=>[e(f,{modelValue:n.batchSize,"onUpdate:modelValue":l[7]||(l[7]=a=>n.batchSize=a),min:1,max:20,style:{width:"100%"}},null,8,["modelValue"]),l[19]||(l[19]=s("div",{class:"form-tip"},"1表示禁用批处理",-1))]),_:1,__:[19]})]),_:1}),e(u,{span:12},{default:t(()=>[e(i,{label:"批处理超时(秒)"},{default:t(()=>[e(f,{modelValue:n.batchTimeoutSeconds,"onUpdate:modelValue":l[8]||(l[8]=a=>n.batchTimeoutSeconds=a),min:1,max:30,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:20,class:"suggestions-section"},{default:t(()=>[e(u,{span:24},{default:t(()=>[e(V,null,{header:t(()=>l[20]||(l[20]=[s("span",null,"性能优化建议",-1)])),default:t(()=>[(w(!0),k(Z,null,$(x.value,a=>(w(),ee(M,{key:a.type,title:a.title,description:a.description,type:a.type,closable:!1,class:"suggestion-alert"},null,8,["title","description","type"]))),128))]),_:1})]),_:1})]),_:1})])}}},we=T(fe,[["__scopeId","data-v-0efbe68b"]]);export{we as default};
